## Title: [3Week] 이승훈

### 미션 요구사항 분석 & 체크리스트
- 2022-10-31 -10:00 ~ 11-2 -18:00
---
**필수 과제**

- [x]  관리자 회원
- [x]  관리자 페이지
- [x]  정산 데이터 생성
- [x]  건별 정산 처리
- [x]  전체 정산 처리(선택 처리)

**추가 과제**
- [x]  예치금 입금 신청 기능(사용자 기능)
- [x]  예치금 출금 신청 기능(사용자 기능)
- [x]  예치금 출금 처리 기능(관리자 기능)
- [x]  정산 데이터 배치로 생성
- [x]  배치가 매달 15일 새벽 4시에 실행
--- 
### 3주차 미션 요약
### 관리자

- [x] 관리자만 관리자 페이지 접속이 가능하다.
  -  [x] authLevel 7인 관리자 회원을 생성
- [x] 관리자 홈 페이지
- [x] 관리자 출금 페이지
- [x] 관리자 정산 페이지

### 입금

- [x] 사용자는 원하는 액수만큼 서비스에 예치금 입금 가능
  - [x] 토스페이먼츠를 활용하여 예치금 입금

- [x] 모든 현금 흐름은 CashLog에 기록된다.
  - [x] CashLog 테이블은 사이버 머니에 대한 기록 테이블이다.


### 출금

- [x] 사용자는 본인이 보유한 예치금에 대해서 출금 신청 가능
  - [x] 보유한 예치금 이하의 금액만 출금 신청 가능
  - [x] 출금 신청 후 예치금을 사용하였을 경우 남은 예치금과 출금 신청한 금액 비교 
  
- [x] 출금 신청 시에는 금액과 통장, 계좌번호를 입력한다.
  - [x] 예치금에서 돈을 출금 신청 할 수 있다.

- [x] 관리자는 사용자가 출금 신청한 내역을 확인하고 처리할 수 있다.
  - [x] 건 별 처리
  - [x] 전체 또는 선택한 건에 대한 처리
  - [x] 출금 수수료는 0원

- [x] 모든 현금 흐름은 CashLog에 기록된다.
  - [x] CashLog 테이블은 사이버 머니에 대한 기록 테이블이다.

### 정산

- [x] 관리자는 원하는 월을 선택하여 정산 데이터 생성이 가능하다.
- [x] 정산 데이터는 결제된 주문 목록으로 이루어져 있다.
  - [x] 건 별 정산이 가능하다.
  - [x] 전체 또는 선택한 건에 대한 정산이 가능하다.
  - [x] 환불된 주문은 정산이 불가능하다.
  - [x] PG 수수료는 0원으로 가정한다.
  - [x] 정산 비율은 판매자와 멋북스가 5:5로 나눈다.

### 배치 정산 
- [x] 스프링 배치를 활용하여 정산 데이터를 생성
- [x] 정산데이터와 주문아이템은 각 1:1 의 관계

### 스케쥴러 
- [x] 스프링 내장 스케쥴러를 이용해서 배치가 매달 15일 새벽 4시에 실행되도록 설정

---
**[접근 방법]**
- 목표했던 기능이 정상적으로 수행되는지를 우선적으로 판단하여 개발하고 추후 리팩토링을 진행한다.
- Ui 작업의 시간을 최소화하기 위해 이전에 사용한 Ui 템플릿을 사용한다.
- 이전에 수행한 배치 강의와 프로젝트를 참고하여 작업을 진행한다.

**[참고]**
- 스프링 배치 https://github.com/sh970901/spring_batch
- 스프링 배치 + 스케쥴러 https://gimmesome.tistory.com/204

**[결과물]**
- 사용자는 서비스에 예치금을 입금, 출금이 가능하다.
- 관리자는 출금 신청을 건별, 선택한 건 별로 처리가 가능하다.
- 관리자는 선택한 월에 대한 정산 데이터를 생성하고 처리할 수 있다.
- 서비스는 매달 15일 새벽 4시 정산 데이터를 생성한다.

**[특이사항]**
- 정산 비율을 판매자와 멋북스가 5:5로 나눈다면 관리자 계정에 캐시를 충전 해야하는 것인가요?

[Refactoring]
  - 코드 단순화, 일관성
  - DB 접근 횟수 단축
  - 테스트 코드 작성
